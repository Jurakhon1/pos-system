# Группировка блюд по категориям в POS системе

## Описание

Реализована улучшенная система отображения блюд на странице POS с группировкой по категориям для лучшей организации и навигации.

## Основные возможности

### 1. Группировка блюд по категориям
- Блюда автоматически группируются по их категориям
- Каждая категория отображается с заголовком и количеством блюд
- Возможность сворачивания/разворачивания категорий

### 2. Улучшенная фильтрация
- Фильтрация по выбранной категории
- Поиск по названию и описанию блюд
- Фильтр "Только с фото" для показа блюд с изображениями
- Сортировка по названию, цене или категориям

### 3. Интерактивные элементы
- Клик по заголовку категории для быстрой фильтрации
- Кнопки сворачивания/разворачивания категорий
- Плавные анимации при переходах

### 4. Статистика и информация
- Отображение общего количества блюд
- Количество категорий
- Количество блюд с фотографиями
- Информация об активных фильтрах

## Технические детали

### Структура данных
```typescript
interface MenuItem {
  id: string;
  name: string;
  price: number;
  description: string;
  image_url?: string;
  category_id: string;
  category: {
    id: string;
    name: string;
  };
}
```

### Ключевые компоненты
- `groupedMenuItems` - объект с группированными блюдами по категориям
- `collapsedCategories` - состояние свернутых категорий
- `filteredMenuItems` - отфильтрованные блюда с учетом всех параметров

### Фильтрация
```typescript
const filteredMenuItems = menuItems?.filter((item: MenuItem) => {
  const matchesCategory = selectedCategory === null || item.category_id === selectedCategory;
  const matchesSearch = item.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                       (item.description && item.description.toLowerCase().includes(searchQuery.toLowerCase()));
  const matchesImages = !showOnlyWithImages || item.image_url;
  return matchesCategory && matchesSearch && matchesImages;
});
```

### Группировка
```typescript
const groupedMenuItems = useMemo(() => {
  if (!filteredMenuItems) return {};
  
  const grouped: Record<string, MenuItem[]> = {};
  
  filteredMenuItems.forEach(item => {
    const categoryName = item.category?.name || 'Без категории';
    if (!grouped[categoryName]) {
      grouped[categoryName] = [];
    }
    grouped[categoryName].push(item);
  });
  
  // Сортировка блюд внутри категорий
  Object.keys(grouped).forEach(categoryName => {
    if (sortBy === 'name') {
      grouped[categoryName].sort((a, b) => a.name.localeCompare(b.name));
    } else if (sortBy === 'price') {
      grouped[categoryName].sort((a, b) => Number(a.price) - Number(b.price));
    }
  });
  
  return grouped;
}, [filteredMenuItems, sortBy]);
```

## UI/UX улучшения

### Визуальная организация
- Четкое разделение категорий с заголовками
- Счетчики блюд в каждой категории
- Цветовое кодирование и иконки

### Навигация
- Быстрый переход к категории при клике на заголовок
- Плавная прокрутка к фильтрам
- Интуитивные кнопки управления

### Адаптивность
- Responsive дизайн для разных размеров экрана
- Оптимизированная сетка для мобильных устройств

## Тестирование

Создан набор тестов для проверки функциональности:
- Группировка блюд по категориям
- Фильтрация и поиск
- Статистика и счетчики
- Интерактивные элементы

Запуск тестов:
```bash
npm test pos-categories.test.tsx
```

## Использование

### Для пользователей
1. **Просмотр категорий**: Блюда автоматически группируются по категориям
2. **Фильтрация**: Используйте кнопки категорий для быстрой фильтрации
3. **Поиск**: Введите название блюда в поле поиска
4. **Сворачивание**: Нажмите на стрелку для сворачивания категории
5. **Сброс**: Используйте кнопку "Сбросить" для очистки всех фильтров

### Для разработчиков
- Все изменения реализованы в `src/app/pos/page.tsx`
- Используются React hooks для управления состоянием
- Применены принципы FSD архитектуры
- Добавлены TypeScript типы для безопасности

## Преимущества

1. **Лучшая организация**: Блюда логически сгруппированы по категориям
2. **Быстрая навигация**: Легко найти нужную категорию
3. **Улучшенный UX**: Интуитивный интерфейс с анимациями
4. **Гибкость**: Множество вариантов фильтрации и сортировки
5. **Производительность**: Оптимизированные вычисления с useMemo

## Будущие улучшения

- Добавление drag-and-drop для изменения порядка категорий
- Сохранение состояния свернутых категорий в localStorage
- Экспорт меню по категориям
- Интеграция с системой управления меню
- Добавление цветовых тем для разных категорий
